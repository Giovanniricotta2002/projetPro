# üõ†Ô∏è Plan de Correction des Bogues - MuscuScope

> **Crit√®re C2.3.2** - √âlaborer un plan de correction des bogues √† partir de l'analyse des anomalies et des r√©gressions d√©tect√©es au cours de la recette afin de garantir le fonctionnement du logiciel conform√©ment √† l'attendu.

## üéØ Objectifs du plan de correction

Ce document d√©finit la m√©thodologie et les processus pour analyser, prioriser et corriger les anomalies d√©tect√©es dans MuscuScope, garantissant ainsi la qualit√© et la stabilit√© de l'application.

---

## üìä Classification des Anomalies

### Niveaux de criticit√©

| Niveau | Description | Exemple | SLA Correction |
|--------|-------------|---------|----------------|
| üî¥ **CRITIQUE** | Blocage complet de l'application | Crash serveur, perte de donn√©es | **4h** |
| üü† **MAJEUR** | Fonctionnalit√© principale indisponible | Connexion impossible, API down | **24h** |
| üü° **MINEUR** | Dysfonctionnement partiel | Interface d√©grad√©e, lenteurs | **72h** |
| üîµ **COSM√âTIQUE** | Probl√®me d'affichage sans impact | Couleur incorrecte, texte mal align√© | **1 semaine** |

### Types d'anomalies

```mermaid
flowchart TD
    Bug[üêõ Anomalie D√©tect√©e]
    
    Bug --> Func[üîß Fonctionnelle]
    Bug --> Perf[‚ö° Performance] 
    Bug --> Secu[üîí S√©curit√©]
    Bug --> UI[üé® Interface]
    Bug --> Data[üíæ Donn√©es]
    
    Func --> FuncEx[Ex: Calcul incorrect, flux cass√©]
    Perf --> PerfEx[Ex: Lenteur, timeout]
    Secu --> SecuEx[Ex: Faille XSS, acc√®s non autoris√©]
    UI --> UIEx[Ex: Responsive cass√©, bouton non cliquable]
    Data --> DataEx[Ex: Corruption, perte d'int√©grit√©]
```

---

## üîç Processus d'Analyse des Anomalies

### 1. Collecte et Consignation

#### **Fiche d'Anomalie Standard**
```yaml
ID_ANOMALIE: BUG-2025-001
DATE_DETECTION: 2025-07-20T14:30:00Z
RAPPORTEUR: qa.team@muscuscope.com
CRITICITE: MAJEUR
TYPE: FONCTIONNELLE

ENVIRONNEMENT:
  - Version: 1.2.0
  - Navigateur: Chrome 126.0
  - OS: Windows 11
  - URL: https://staging.muscuscope.com/machines

DESCRIPTION:
  "La liste des machines ne se charge pas apr√®s connexion.
   Erreur 500 retourn√©e par l'API /api/machines"

REPRODUCTION:
  1. Se connecter avec user@test.com
  2. Naviguer vers /machines
  3. Observer l'erreur 500

DONNEES_TECHNIQUES:
  - Stack trace: TypeError: Cannot read property 'length' of undefined
  - Request ID: req-789456123
  - User Agent: Mozilla/5.0...
  - IP: 192.168.1.100

IMPACT:
  - Utilisateurs affect√©s: Tous les utilisateurs connect√©s
  - Fonctionnalit√©s bloqu√©es: Consultation machines
  - Contournement: Aucun disponible

PIECES_JOINTES:
  - screenshot_error.png
  - network_logs.har
  - server_logs.txt
```

### 2. Analyse Technique Approfondie

#### **Grille d'Analyse RCA (Root Cause Analysis)**

```markdown
## üîç Analyse de l'Anomalie BUG-2025-001

### Contexte Initial
- **Quand** : Depuis le d√©ploiement v1.2.0 (20/07/2025 12:00)
- **O√π** : Environnement staging et production
- **Qui** : Tous les utilisateurs authentifi√©s
- **Quoi** : API /api/machines retourne 500

### Investigation Technique

#### 1. Analyse des Logs Serveur
```bash
# Symfony logs
[2025-07-20 14:30:15] request.CRITICAL: Uncaught exception 'TypeError'
at MachineController.php:45 in index()

# PostgreSQL logs  
[2025-07-20 14:30:15] ERROR: column "created_at" does not exist
LINE 1: SELECT id, name, description, created_at FROM machines
```

#### 2. Analyse du Code
```php
// Probl√®me identifi√© dans MachineController
public function index(): JsonResponse
{
    // ‚ùå Erreur: tentative d'acc√®s √† une colonne supprim√©e
    $machines = $this->machineRepository->findAllWithCreatedAt();
    //                                     ^^^^^^^^^^^^^^^
    //                                     M√©thode obsol√®te
}
```

#### 3. Analyse de la Migration
```sql
-- Migration 20250720_remove_created_at.sql (v1.2.0)
ALTER TABLE machines DROP COLUMN created_at;
-- ‚ùå Colonne supprim√©e mais code non mis √† jour
```

### Cause Racine Identifi√©e
- **Type** : R√©gression lors de migration base de donn√©es
- **Origine** : D√©synchronisation entre migration DB et code m√©tier  
- **Facteur** : Tests d'int√©gration insuffisants sur ce flux
```

### 3. Priorisation et Impact Business

#### **Matrice d'Impact**
```markdown
| Criticit√© | Impact Utilisateur | Impact Business | Priorit√© |
|-----------|-------------------|-----------------|----------|
| CRITIQUE | 100% bloqu√©s | Perte revenus imm√©diate | P0 |
| MAJEUR | 50%+ affect√©s | Fonctionnalit√© core down | P1 |
| MINEUR | <20% affect√©s | D√©gradation UX | P2 |
| COSM√âTIQUE | N√©gligeable | Aucun | P3 |
```

---

## üîß Strat√©gies de Correction

### Approche par Type d'Anomalie

#### **üî¥ CRITIQUE - Proc√©dure d'Urgence**
```bash
# 1. Alerte imm√©diate √©quipe (Slack, SMS)
# 2. Rollback automatique si possible
kubectl rollout undo deployment/backend-api

# 3. Hotfix en parall√®le
git checkout -b hotfix/critical-bug-fix
# Fix rapide + tests unitaires
git commit -m "hotfix: correction bug critique #BUG-2025-001"

# 4. D√©ploiement express
./deploy-hotfix.sh production

# 5. Validation post-correction
./validate-critical-fix.sh
```

#### **üü† MAJEUR - Correction Planifi√©e**
```markdown
1. **Analyse approfondie** (2h max)
   - Root cause analysis compl√®te
   - Impact assessment d√©taill√©
   - Plan de correction valid√©

2. **D√©veloppement de la correction** (8h max)
   - Fix principal + tests de r√©gression
   - Code review obligatoire
   - Tests automatis√©s √©tendus

3. **D√©ploiement staging** 
   - Validation QA compl√®te
   - Tests de non-r√©gression
   - Validation Product Owner

4. **D√©ploiement production**
   - Blue/Green deployment
   - Monitoring renforc√©
   - Plan de rollback ready
```

#### **üü° MINEUR - Cycle Normal**
```markdown
1. **Priorisation dans backlog** selon sprint planning
2. **D√©veloppement** dans le cycle normal
3. **Tests** complets selon processus standard
4. **D√©ploiement** avec prochaine release
```

---

## üìã Templates de Correction

### Template Hotfix Critique

```yaml
HOTFIX_ID: HF-2025-001
ANOMALIE_SOURCE: BUG-2025-001
DEVELOPPEUR: giovanni.ricotta@muscuscope.com
DATE_DEBUT: 2025-07-20T15:00:00Z

ANALYSE_RAPIDE:
  Probl√®me: "API machines indisponible"
  Cause: "Colonne created_at supprim√©e mais code non mis √† jour"
  Solution: "Mise √† jour MachineController + Repository"

CHANGEMENTS:
  Fichiers:
    - src/Controller/MachineController.php: "Suppression r√©f√©rence created_at"
    - src/Repository/MachineRepository.php: "Mise √† jour requ√™te SQL"
  Tests:
    - tests/Controller/MachineControllerTest.php: "Nouveau test API"
    - tests/Integration/MachineFlowTest.php: "Test end-to-end"

VALIDATION:
  - [ ] Tests unitaires passent
  - [ ] Tests d'int√©gration OK
  - [ ] Validation staging OK
  - [ ] Code review approuv√©
  - [ ] Monitoring post-d√©ploiement OK

ROLLBACK_PLAN:
  - Commande: "kubectl rollout undo deployment/backend-api"
  - Timeout: "5 minutes max"
  - Validation: "curl -f /api/health"
```

### Template Correction Standard

```yaml
CORRECTION_ID: FIX-2025-001
ANOMALIE_SOURCE: BUG-2025-002
SPRINT: Sprint-15
ASSIGNEE: dev.team@muscuscope.com

ANALYSE_COMPLETE:
  Description: "Interface mobile responsive cass√©e"
  Impact: "20% utilisateurs mobiles affect√©s"
  Complexit√©: "MOYENNE"
  Estimation: "3 story points"

SPECIFICATION_TECHNIQUE:
  - Ajustement CSS media queries
  - Tests visuels sur 3 r√©solutions
  - Validation accessibilit√© WCAG

PLAN_DE_TEST:
  - Tests automatis√©s: Playwright multi-device
  - Tests manuels: iPhone/Android
  - Tests accessibilit√©: Axe-core

CRITERES_ACCEPTATION:
  - [ ] Interface fonctionnelle sur mobile
  - [ ] Performance maintenue
  - [ ] Aucune r√©gression desktop
  - [ ] Tests automatis√©s mis √† jour
```

---

## üîÑ Workflow de Correction

### Processus G√©n√©ral

```mermaid
flowchart TD
    Detection[üîç D√©tection Anomalie]
    Triage[üìã Triage & Classification]
    
    Detection --> Triage
    
    Triage --> Critique{üî¥ CRITIQUE ?}
    Triage --> Majeur{üü† MAJEUR ?}
    Triage --> Mineur{üü° MINEUR ?}
    
    Critique -->|OUI| Urgence[üö® Proc√©dure Urgence]
    Majeur -->|OUI| Planifie[üìÖ Correction Planifi√©e]
    Mineur -->|OUI| Backlog[üìù Backlog Sprint]
    
    Urgence --> HotfixDev[‚ö° D√©veloppement Hotfix]
    Planifie --> StdDev[üîß D√©veloppement Standard]
    Backlog --> SprintDev[üìã D√©veloppement Sprint]
    
    HotfixDev --> HotfixTest[üß™ Tests Express]
    StdDev --> StdTest[üß™ Tests Complets]
    SprintDev --> SprintTest[üß™ Tests Sprint]
    
    HotfixTest --> Deploy{üöÄ D√©ploiement}
    StdTest --> Deploy
    SprintTest --> Deploy
    
    Deploy --> Monitor[üìä Monitoring]
    Monitor --> Validate[‚úÖ Validation]
    
    Validate --> Close[‚úÖ Cl√¥ture]
    Validate -->|KO| Rollback[‚Ü©Ô∏è Rollback]
    
    Rollback --> Detection
```

### Outils et Automatisation

#### **CI/CD Pipeline pour Corrections**

```yaml
# .github/workflows/hotfix.yml
name: Hotfix Pipeline
on:
  push:
    branches: [hotfix/*]

jobs:
  tests-rapides:
    runs-on: ubuntu-latest
    steps:
      - name: Tests critiques seulement
        run: ./bin/phpunit --group=critical
        timeout-minutes: 5
      
  deploy-staging:
    needs: tests-rapides
    runs-on: ubuntu-latest
    steps:
      - name: Deploy staging
        run: ./deploy-staging.sh
      
      - name: Tests smoke
        run: ./smoke-tests.sh
        timeout-minutes: 2
        
  deploy-production:
    needs: deploy-staging
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/hotfix/critical'
    steps:
      - name: Deploy production
        run: ./deploy-production.sh
        
      - name: Monitoring post-deploy
        run: ./monitor-deployment.sh
        timeout-minutes: 10
```

---

## üìä M√©triques et KPIs

### Indicateurs de Performance

```markdown
## üìà Dashboard Corrections - Semaine 29/2025

### Volum√©trie
- üêõ **Total anomalies** : 15
  - üî¥ Critiques : 1 (7%)
  - üü† Majeures : 3 (20%)  
  - üü° Mineures : 8 (53%)
  - üîµ Cosm√©tiques : 3 (20%)

### Performance SLA
- ‚è±Ô∏è **Temps de r√©solution moyen** :
  - Critiques : 2h (SLA: 4h) ‚úÖ
  - Majeures : 18h (SLA: 24h) ‚úÖ
  - Mineures : 45h (SLA: 72h) ‚úÖ

### Qualit√©
- üéØ **Taux de correction au premier essai** : 87%
- üîÑ **Taux de r√©gression** : 5%
- ‚úÖ **Satisfaction √©quipe** : 8.5/10
```

### Analyse des Tendances

```markdown
## üìä Analyse Mensuelle - Juillet 2025

### Top 3 Sources d'Anomalies
1. **Migrations DB** (40%) - Action : Am√©liorer tests d'int√©gration
2. **Interface mobile** (25%) - Action : Renforcer tests cross-device
3. **Performance API** (20%) - Action : Monitoring proactif

### Efficacit√© du Processus
- ‚¨áÔ∏è **Diminution anomalies critiques** : -60% vs mois pr√©c√©dent
- ‚¨ÜÔ∏è **Am√©lioration time-to-fix** : +25% plus rapide
- ‚úÖ **Z√©ro incident production** : 15 jours cons√©cutifs
```

---

## üéØ Pr√©vention et Am√©lioration Continue

### Actions Pr√©ventives

#### **Renforcement des Tests**
```markdown
1. **Tests de migration automatis√©s**
   - Validation sch√©ma DB vs code
   - Tests de compatibilit√© ascendante
   - Rollback automatique en cas d'√©chec

2. **Tests de r√©gression √©tendus**
   - Couverture critique √† 100%
   - Tests cross-browser automatis√©s
   - Tests de charge avant release

3. **Monitoring proactif**
   - Alertes sur m√©triques d√©grad√©es
   - Health checks business logic
   - D√©tection d'anomalies par IA
```

#### **Formation √âquipe**
```markdown
1. **Sessions techniques mensuelles**
   - Post-mortem des incidents majeurs
   - Bonnes pratiques debugging
   - Nouveaux outils et m√©thodes

2. **Documentation vivante**
   - Base de connaissances incidents
   - Runbooks op√©rationnels
   - Guide troubleshooting
```

---

## üìû Contacts et Escalade

### Matrice de Responsabilit√©s

| Type Anomalie | Premi√®re Intervention | Escalade | Validation |
|---------------|----------------------|----------|------------|
| **Critique** | DevOps On-call | CTO | Product Owner |
| **Majeure** | Tech Lead | Engineering Manager | Product Owner |
| **Mineure** | Developer assign√© | Tech Lead | QA Lead |
| **Cosm√©tique** | Developer assign√© | - | QA Lead |

### Contacts d'Urgence

```markdown
üö® **Astreinte DevOps** : +33 6 XX XX XX XX
üìß **Tech Lead** : giovanniricotta2002@gmail.com  
üì± **Product Owner** : giovanniricotta2002@gmail.com
```

---

## üìö Documentation et Tra√ßabilit√©

### Outils de Suivi

- **Ticketing** : Jira/Linear pour tra√ßabilit√© compl√®te
- **Documentation** : Confluence/Notion pour runbooks
- **Communication** : Slack pour coordination temps r√©el
- **Monitoring** : Grafana/DataDog pour observabilit√©

### Archives et Post-Mortem

```markdown
## üìã Template Post-Mortem

### Incident Summary
- **Date** : 2025-07-20
- **Duration** : 2h 15min
- **Impact** : 1000 utilisateurs affect√©s
- **Root Cause** : Migration DB non synchronis√©e

### Timeline
- 14:30 - D√©tection anomalie
- 14:35 - Alerte √©quipe
- 14:45 - D√©but investigation
- 15:15 - Cause identifi√©e
- 15:30 - Hotfix d√©velopp√©
- 16:00 - D√©ploiement production
- 16:45 - Validation compl√®te

### Actions Correctives
1. ‚úÖ Am√©liorer tests de migration
2. ‚úÖ Alerting proactif sur API errors
3. ‚úÖ Formation √©quipe sur process urgence

### Lessons Learned
- Migration DB/Code doit √™tre atomique
- Tests d'int√©gration critiques √† renforcer
- Communication incident efficace
```

---

**üõ†Ô∏è Ce plan de correction garantit une r√©ponse rapide et efficace aux anomalies, assurant la qualit√© continue de MuscuScope.**
